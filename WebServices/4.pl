<!DOCTYPE html>
<!-- saved from url=(0047)https://intranet.tiwi.ugent.be/Windows/Labo/p6/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="generator" content="intranetr/0.10.0">
<title>Reeks 6 | iii intranet</title>    <link rel="stylesheet" type="text/css" media="screen,handheld" href="./4_files/default.css">
    <link rel="stylesheet" type="text/css" media="print" href="./4_files/print.css">
    <link rel="stylesheet" type="text/css" media="screen,handheld" href="./4_files/default(1).css">
    <script type="text/javascript" async="" src="./4_files/ga.js"></script><script type="text/javascript" src="./4_files/0d6197553acf19ea859c96f7caf7d8fa6c6519b8.js"></script>
<!--[if lt IE 8]>
<link rel="stylesheet" type="text/css" href="/css/ie.css">
<![endif]-->
    <script type="text/javascript">
    (function() {
        var month = 11;
        iii.semester = month == 1 ? 1
            : month <= 6 ? 2
            : month <= 9 ? 0 : 1;
        if (iii.semester > 0) {
            var hideOtherSemester = function() {
                var other = iii.semester == 1 ? 2 : 1;
                $('#breadcrumbs li.group-sem'
                        + other
                        + ':not(.group-sem'
                        + iii.semester + '):not(.active)')
                    .hide();
            };
            $(document)
                .ready(hideOtherSemester)
                .on("contentUpdate.iii", hideOtherSemester);
        }
    })();
    </script>
<style type="text/css"></style></head>

<body style="padding-bottom: 200px;">
    <div id="header"><h1>
    <a href="https://intranet.tiwi.ugent.be/" title="Naar de thuispagina">
        intranet
    </a>
</h1>
</div>
<div id="main">    <div id="node-children">
    <ul>
            <li><a href="https://intranet.tiwi.ugent.be/Windows/Labo/"><span style="float: right">↑</span>Omhoog</a></li>
            </ul>
    </div>

<div id="content" class="">
        <div id="breadcrumbs-container">
    <span id="you-are-here">Je bent hier:</span>
    <ul id="breadcrumbs">
                            <li class="breadcrumb first"><a href="https://intranet.tiwi.ugent.be/" class="breadcrumb first">Intranet</a>
                </li>
                            <li class="breadcrumb"><a href="https://intranet.tiwi.ugent.be/Windows/" class="breadcrumb">Windows</a>
                    <ul class="breadcrumb-siblings">
                                                <li class="separator"><span>Tweede bachelor</span></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="https://intranet.tiwi.ugent.be/Computernetwerken-I/">Computernetwerken I</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="https://intranet.tiwi.ugent.be/Informatica-II/">Informatica II</a></li>
                                                                <li class="separator"><span>Derde bachelor</span></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="https://intranet.tiwi.ugent.be/Databanken/">Databanken</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="https://intranet.tiwi.ugent.be/Discrete-Wiskunde/">Discrete wiskunde</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="https://intranet.tiwi.ugent.be/Systeemanalyse-I/">Systeemanalyse I</a></li>
                                                                <li class="separator"><span>Master</span></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="https://intranet.tiwi.ugent.be/Algoritmen-II/">Algoritmen II</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="https://intranet.tiwi.ugent.be/Beveiliging/">Beveiliging</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="https://intranet.tiwi.ugent.be/Computergrafiek/">Computergrafiek</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1"><a class="breadcrumb-sibling group-sem1" href="https://intranet.tiwi.ugent.be/Computernetwerken-IV/">Computernetwerken IV</a></li>
                                                                                                                                                                                                                                                            <li class="breadcrumb-sibling group-sem1 group-sem2 leaf"><a class="breadcrumb-sibling group-sem1 group-sem2 leaf" href="https://intranet.tiwi.ugent.be/Masterproef/">Masterproef</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 leaf"><a class="breadcrumb-sibling group-sem1 leaf" href="https://intranet.tiwi.ugent.be/Systeemanalyse-II/">Systeemanalyse II</a></li>
                                                                                                                                                                                                                <li class="breadcrumb-sibling group-sem1 active"><a class="breadcrumb-sibling group-sem1 active" href="https://intranet.tiwi.ugent.be/Windows/">Windows</a></li>
                                                                <li class="separator"><span>Algemeen</span></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Activiteiten/">Activiteiten</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Huisregels-labos/">Huisregels voor labo's</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Opleiding-Informatica/">Opleiding Informatica GTI</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Andere-problemen/">Probleemoplossende instanties</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling"><a class="breadcrumb-sibling" href="https://intranet.tiwi.ugent.be/Roosters/">Roosters</a></li>
                                        </ul>
                </li>
                            <li class="breadcrumb"><a href="https://intranet.tiwi.ugent.be/Windows/Labo/" class="breadcrumb">Labo</a>
                    <ul class="breadcrumb-siblings">
                                                                                                                                                    <li class="breadcrumb-sibling active"><a class="breadcrumb-sibling active" href="https://intranet.tiwi.ugent.be/Windows/Labo/">Labo</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Windows/Theorie/">Theorie</a></li>
                                        </ul>
                </li>
                            <li class="breadcrumb"><a href="./4_files/4.pl" class="breadcrumb">Reeks 6</a>
                    <ul class="breadcrumb-siblings">
                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Windows/Labo/p0/">Reeks 0</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Windows/Labo/p1/">Reeks 1</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Windows/Labo/p2/">Reeks 2</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Windows/Labo/p3/">Reeks 3</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Windows/Labo/p4/">Reeks 4</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf"><a class="breadcrumb-sibling leaf" href="https://intranet.tiwi.ugent.be/Windows/Labo/p5/">Reeks 5</a></li>
                                                                                                                                                                    <li class="breadcrumb-sibling leaf active current"><a class="breadcrumb-sibling leaf active current" href="./4_files/4.pl">Reeks 6</a></li>
                                        </ul>
                </li>
        </ul>
    </div>
    <h2>Reeks 6</h2>
    <div id="page-content">
        <h3>raadplegen en wijzigen van Active Directory objecten</h3>
<h4>Verplichte voorbereiding voor 21 november:</h4>
<ul>
<li>Neem de inleidende tekst grondig door en maak de oefeningen
1,2,4,6,7,10.</li>
<li>Installeer de <em>ADSI Edit snapin</em>, beschikbaar in de MMC
console <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=49ae8576-9bb9-4126-9761-ba8011fabf38&hash=RWRPDM9">
<strong>adsiedit.msc</strong></a> waarmee je de Active Directory
objecten kan visualiseren (zie theorie).</li>
</ul>
<h4>Active Directory</h4>
Het domein <strong>iii.hogent.be</strong> beschikt momenteel over
twee <em>Domain Controllers</em>, <strong>Belial</strong> en
<strong>Satan</strong>, waarvan er één wordt toegekend bij elke
aanvraag om Active Directory informatie. Tijdens de labo's ben je
reeds ingelogd op het domein <strong>iii.hogent.be</strong>. Indien
je van thuis uit deze oefeningen wilt maken, ben je niet ingelogd
op het domein <em>iii.hogent.be</em> en zal je twee extra
instellingen moeten doen:
<ul>
<li>je moet de naam van de server (of van het domein) expliciet
opgeven. De <em>interne</em> DNS-naam en ip-adres van de
domeincontroller <strong>Satan</strong> zijn respectievelijk
<strong>satan.iii.hogent.be</strong> en
<strong>192.168.16.16</strong>. Aangezien de configuratie van het
<em>iii.hogent.be</em> domein en zijn toestellen van het publieke
Internet wordt afgeschermd, moet je als serveridentificatie steeds
expliciet de <em>externe</em> DNS-naam of ip-adres van een
domeincontroller opgeven. Bovendien is enkel <strong>Satan</strong>
publiek bereikbaar: hetzij via <strong>satan.hogent.be</strong>,
hetzij via <strong>193.190.126.71</strong>, .</li>
<li>je loginnaam/paswoord om toegang te krijgen tot het domein
moeten worden opgegeven.</li>
</ul>
Indien een VPN-connectie wordt geïnitialiseerd kan het voorkomen
dat Satan niet meer bereikbaar is, en dat het connecteren dus niet
lukt.
<h5>AdsiEdit</h5>
Om de AD omgeving intuïtief te benaderen gebruik je de grafische
interface <strong>AdsiEdit</strong>.<br>
Als je de eerste keer <strong>AdsiEdit</strong> opstart moet je
zelf de connectie maken met het domein. Indien je niet op het
domein bent ingelogd moet je de correcte DNS-naam of het correcte
ip-adres van de server opgeven, en onder <strong>Advanced</strong>
je loginnaam/paswoord ingeven. In tegenstelling tot WMI zitten de
klassen en de instanties in verschillende top-level containers van
AD, <em>partities</em> genoemd (zie theorie). In
<strong>AdsiEdit</strong> kan je connecteren met minimaal drie
partities:
<ul>
<li>de <em>schema partitie</em>: bevat de beschrijving van alle
beschikbare klassen en attributen (zie theorie over het reële (en
abstracte) schema, en de oefeningen verderop),</li>
<li>de <em>domain partitie</em> bevat de domeingegevens: dit zijn
"instanties" van de klassen. Elk domeingegeven wordt beschreven
door een <strong>AD&nbsp;object</strong> in het
<strong>domein</strong>,</li>
<li>de <em>configuration partitie</em> bevat
configuratiegegevens.</li>
</ul>
Bekijk met behulp van <strong>AdsiEdit</strong> een willekeurig
<strong>AD&nbsp;object</strong> in het <strong>domein</strong> en
vraag alle <strong>properties/eigenschappen</strong>. Je bekomt een
lijst met alle beschikbare <strong>LDAP-attributen</strong>,
ondermeer de <em>distinguishedName</em>, de
<em>Objectclass</em>,... Je kan ook de waarde opvragen van elk
<strong>LDAP-attribuut</strong>.
<h4>LDAP vs. ADSI</h4>
Er zijn twee manieren om Active Directory programmatorisch te
manipuleren: de <strong>Lightweight Directory Access Protocol
Application Program Interface (LDAP API)</strong>, en de
<strong>Active Directory Service Interfaces (ADSI)</strong>. Het
LDAP protocol definieert een aantal basis operaties bovenop TCP,
die het cliënts mogelijk maken om data in een willekeurige Active
Directory te raadplegen en aan te passen. De meeste operaties
bestaan uit eenvoudige <a class="popout disable-history" href="https://intranet.tiwi.ugent.be/Windows/Labo/p6/adp0302.gif">vraag/antwoord wisselwerkingen</a>, analoog aan
deze in het HTTP protocol, tussen Web cliënt en server. De LDAP API
programmeerinterface wordt geïmplementeerd door de
<strong>wldap32.dll</strong> module van elk Windows platform met
een Active Directory cliënt, en bevat een aantal functies die het
de programmeertaal&nbsp;C toelaten om te communiceren met LDAP
servers. De LDAP API veroorzaken <strong>weinig overhead</strong>
en zijn hierdoor zeer snel. Bovendien zijn programma's die gebruik
maken van de LDAP API met geringe moeite
<strong>overdraagbaar</strong> op andere besturingssystemen. De
LDAP API voorzien niet in een object georiënteerde interface. Het
programmeren van eenvoudige cliënts is ondermeer daardoor <a class="popout disable-history" href="https://intranet.tiwi.ugent.be/Windows/Labo/p6/LDAPEnumTop.txt">vrij primitief</a>. Ook is
het moeilijk om de LDAP API aan te wenden in andere
programmeeromgevingen dan&nbsp;C.
<p>ADSI daarentegen voorziet in <strong>COM objecten</strong> die
de low-level LDAP API verbergen in hun implementatie, en een
<strong>object georiënteerde functionaliteit</strong> aanbieden.
Elk <a class="popout disable-history" href="https://intranet.tiwi.ugent.be/Windows/Labo/p6/adp0308.gif"><strong>Active
Directory object</strong></a> wordt door ADSI gerepresenteerd als
een <a class="popout disable-history" href="https://intranet.tiwi.ugent.be/Windows/Labo/p6/adp0308.gif"><strong>ADSI
object</strong></a> <strong>in de geheugenruimte van de
cliënt</strong>. De <a class="popout disable-history" href="https://intranet.tiwi.ugent.be/Windows/Labo/p6/adp0303.gif">provider architectuur</a> maakt het mogelijk om
niet alleen de Windows Server Active Directory te manipuleren, maar
ook andere directories zoals de <em>global catalog</em>, de
<em>Novell Directory Services (NDL)</em>, de <em>metabase</em> van
de <em>Internet Information Server (IIS)</em>, en zelfs de <em>SAM
van NT&nbsp;4.0</em>: specifieke <strong>providers</strong>
communiceren met specifieke directories. Hoe ze dit doen is
volledig afgeschermd van de cliënt toepassingen. ADSI is
geïmplementeerd als een <strong>in-process</strong> COM component.
De overhead op de performantie blijft hierdoor beperkt. ADSI kan
gebruikt worden vanuit om het even welke programmeertaal. Bovendien
zijn de meeste van de 58 ADSI interfaces <strong>duaal</strong>, en
kunnen ze bijgevolg ook via <em>late binding</em> vanuit
scriptomgevingen aangesproken worden, (zoals WSH met PerlScript of
VBScript, in deze labo's). <strong>Enkel Windows</strong> cliënts
daarentegen ondersteunen ADSI. De meeste ADSI interfaces zijn
gemeenschappelijk voor alle providers, een aantal andere zijn
specifiek.</p>
<p>Deze reeks beperkt zich tot een omschrijving van de
belangrijkste technieken om een <strong>AD&nbsp;object</strong> te
<strong>onderzoeken</strong> door de <em>attributen</em> en
<em>methods</em> aan te sprekende van het bijhorende <strong>ADSI
object</strong>. In de volgende reeks gaan we leren hoe je snel
<strong>AD&nbsp;objecten</strong> kan <strong>opzoeken</strong> aan
de hand van hun eigenschappen. In de laatste reeks leren we ook hoe
je de <strong>eigenschappen</strong> van deze objecten kan
<strong>wijzigen</strong>.</p>
<p>In de <strong>MSDN Library</strong> vind je heel wat
documentatie in de sectie <em>WIN32 and COM Development</em>&nbsp;
/ &nbsp; <nobr><em>Administration and Management</em></nobr>&nbsp;
/ &nbsp;<nobr><em>Directory Services</em></nobr> &nbsp; / &nbsp;
<nobr><em>SDK Documentation</em></nobr>&nbsp; / &nbsp;
<nobr><em>Directory Services</em></nobr><br>
(In de nieuwe versie <strong>MSDN Library 2008 SP1</strong> staat
deze sectie op een andere plaats, nl <nobr><em>WIN32 and COM
Development</em></nobr> / <nobr><em>Administration and
Management</em></nobr> / <nobr><em>Directory, Identity, and Access
Services</em></nobr> / <nobr><em>Directory Services
Overview</em></nobr> )<br>
We gebruiken twee subtakken:</p>
<ul>
<li>De ADSI-interface wordt beschreven in de tak
<nobr><em>Directory Access Technologies</em></nobr> /
<nobr><em><strong>A</strong>ctive <strong>D</strong>irectory
<strong>S</strong>ervice <strong>I</strong>nterfaces</em></nobr> /
<nobr><em>Active Directory Service Interfaces Reference</em></nobr>
.<br>
We noemen deze tak kortweg de <strong>ADSI Library</strong>.</li>
<li>Informatie over Active Directory zoek je op in de tak
<em>Directories</em>. Deze tak noemen we de <strong>AD
Library</strong></li>
</ul>
We zullen in de volgende oefeningen een aantal interessante
subtakken vermelden (zie ook overzicht).
<dl class="compact">
<dt>1.</dt>
<dd>In het <strong>register</strong> vind je de takken
<strong>LDAP</strong> en <strong>LDAPnamespace</strong>. Beiden
refereren (via de CLSID-tak) naar dezelfde Type Library
<strong>Active DS Type Library</strong>, met GUID
<strong>97D25DB0-0363-11CF-ABC4-02608C9E7553</strong>, waar je alle
constanten kan terugvinden. Herneem oefening 9 uit reeks 1 om alle
constanten te tonen van deze bibliotheek.</dd>
</dl>
<h4>Binding van de Active Directory&nbsp;objecten</h4>
Net als bij WMI start elke communicatie met de Active Directory
services met het <em>binden</em> van een
<strong>AD&nbsp;object</strong> (op de server) aan een
<strong>ADSI&nbsp;object</strong> (in de geheugenruimte van de
cliënt). Het <strong>AD&nbsp;object</strong> wordt beschreven met
behulp van de <strong>ADsPath moniker</strong>.
<h5>De ADsPath moniker</h5>
De ADsPath moniker bestaat uit drie delen en beschrijft zowel de
ADSI provider die aangesproken moet worden, als het AD&nbsp;object
dat men wil <em>binden</em>, de <em>facultatieve</em> elementen
staan tussen vierkante haakjes:
<table border="0" width="100%">
<tbody><tr class="alternate">
<td width="5%">&nbsp;</td>
<td><em>provider</em><strong>://</strong> [<em>server</em> |
<em>domein</em> [ <strong>:</strong> <em>poort</em> ]
<strong>/</strong> ] <em>distinguishedName</em></td>
</tr>
</tbody></table>
<ul>
<li><strong>provider</strong>: hier <strong>moet</strong> hetzij
<strong>LDAP</strong>, hetzij <strong>GC</strong> gespecifieerd
worden, afhankelijk of we de domeingegevens, het schema, de
configuratiegevens, dan wel de global catalog willen aanspreken.
Andere ADSI compatibele providers, zoals <strong>NDS</strong>,
<strong>NWCOMPAT</strong>, <strong>IIS</strong> of
<strong>WinNT</strong>, komen in deze labo's niet aan bod. Je vindt
meer informatie in de subtak <nobr><em>Adsi Service
Providers</em></nobr> van de <strong>ADSI Library</strong>. Ga
verder naar de sectie <em>ADSI LDAP Provider / LDAP ADsPath</em>
voor alle informatie over de "ADsPath moniker" in LDAP.</li>
<li><strong>[server | domein [:poort] /]</strong> : het poortnummer
mag je weglaten, LDAP en GC als providers impliceren
respectievelijk TCP poorten 389 en 3268 als <em>default</em>. Het
|-teken maakt hierbij geen deel uit van ADsPath, maar duidt aan dat
hetzij een server, hetzij een domein kan gespecifieerd worden.
Indien enkel een <strong>domeinidentificatie</strong> (hetzij DNS
domeinnaam, hetzij SAM accountnaam) vermeld wordt, poogt de lokale
LDAP cliënt <strong>via DNS</strong> te achterhalen welke server de
provider ondersteunt. Indien een
<strong>serveridentificatie</strong> (DNS domeinnaam, SAM
accountnaam) vermeld wordt, richt de cliënt zich rechtstreeks tot
deze server. Je kan hier echter ook het <strong>ip-adres</strong>
van de server opgeven, waardoor de DNS interactie vermeden wordt
(ga na dat het <em>interne</em> ip-adres van Satan 192.168.16.16
is). Thuis gebruik je uiteraard het externe ip-adres.<br>
Indien zowel de server als het domein ontbreekt, wordt het domein
gebruikt van de ingelogde gebruiker. Enkel indien je als gebruiker
bent ingelogd in het Active Directory domein waarvan je informatie
opvraagt, is het toegelaten om hier <strong>helemaal niets</strong>
te vermelden. </li>
<li><strong>distinguishedName</strong> : verwijst naar het
AD&nbsp;object in het domein en kan je opzoeken in
<strong>AdsiEdit</strong></li>
</ul>
<dl class="compact">
<dt>2.</dt>
<dd>Bepaal de ADsPath moniker van de twee <em>Domain
Controllers</em> <strong>Belial</strong> en <strong>Satan</strong>?
Gebruik <strong>AdsiEdit</strong> om de
<strong>distinguishedName</strong> op te zoeken. Wat is deze
moniker als je thuis werkt? Wat is de moniker als je op school
werkt en dus ingelogd bent op het domein.</dd>
</dl>
<h5>Connecteren met PowerShell</h5>
De methode een <strong>PS Object</strong> te initialiseren is
verschillend indien je wel/niet ingelogd bent op het domein. Indien
je ingelogd bent dan kan di heel eenvoudig met:
<pre> $adObject = [adsi] $moniker 
</pre>
Indien je niet ingelogd bent op het domein, dan is het wat
complexer:
<pre>$adObject = New-Object System.DirectoryServices.DirectoryEntry ($moniker,"Interim F","Interim F")
</pre>
De twee laatste parameters zijn de "username" en "pasword" waarmee
je toegang hebt tot het domein.<br>
De waarde van <code>$moniker</code> is net als hiervoor ingevuld.
We gaan in deze labo's niet verder in op de mogelijkheden die je nu
hebt in PowerShell, maar <strong>Get-Member</strong> kan je alvast
op weg helpen. In een aantal oplossingen wordt ook een opmerking
toegevoegd ivm PowerShell.
<h5>Initialiseren van een ADSI object in PerlScript</h5>
De methode om een <strong>ADSI object</strong> te initaliseren is
ook nu afhankelijk van de situatie. Indien je bent ingelogd op het
domein kan je dezelfde methode gebruiken als bij WMI-objecten:
<pre>     my $object=Win32::OLE-&gt;GetObject(<em>moniker</em>);
</pre>
De terugkeerwaarde is een <strong>ADSI object</strong> dat
refereert naar het AD&nbsp;object, beschreven door de
<em>moniker</em>.<br>
Je kan GEEN gebruik maken van
<code>Win32::OLE-&gt;QueryObjectType($object)</code> om te
controleren of je inderdaad een object hebt geïnitialiseerd. Deze
methode geeft altijd <strong>undef</strong>. Met de perl-methode
<code>ref</code> kan je wel nagaan of je een
<strong>Win32::OLE</strong> object hebt. Indien het initialiseren
niet lukt wordt een fout opgeworpen met meer informatie (gebruik
<strong>Win32::OLE-&gt;LastError()</strong>)
<dl class="compact">
<dt>4.</dt>
<dd>&nbsp;<strong><em>Binden op afstand</em></strong>
<p>Indien je <strong>niet ingelogd bent op het domein</strong> dan
moet je bij elke binding operatie een verificatie procedure
aanvragen. In de <strong>ADSI Library</strong> vind je in de subtak
<em><nobr>ADSI Interfaces</nobr> / <nobr>Core Interfaces</nobr> /
IADsOpenDSObject</em> alle noodzakelijke infomatie over de
<em>IADsOpenDSObject</em> interface, die specifiek is ontworpen om
te kunnen voorzien in een <em>secure</em> context om een AD-object
te binden. Met <em>GetObject</em> initialiseer je een <strong>LDAP
object</strong>. Dan gebruik je de <strong>OpenDSObject</strong>
methode van dit <strong>LDAP object</strong>. Deze methode verwacht
nog drie andere argumenten: de loginnaam en het paswoord om in het
domein in te loggen en een geheel getal, die bits-gewijze
informatie bevat. De <em>bind_object</em> functie in het
onderstaand voorbeeld illustreert dit.<br>
Probeer ook eens een verkeerde moniker en lees de foutmelding.</p>
<p><a class="popout disable-history" href="https://intranet.tiwi.ugent.be/Windows/Labo/p6/04.pl">voorbeeld</a></p>
</dd>
</dl>
<h5>ADSI objecten met ADSI-attributen en ADSI-methoden</h5>
De eenvoudigste methode om AD-objecten te manipuleren is door
gebruik te maken van de <em>ADSI Interfaces</em> die beschikbaar
zijn voor de ADSI objecten. Er zijn meerdere ADSI interfaces, die
elk hun eigen ADSI-methodes en ADSI-attributen aanbieden. Je vindt
hierover enkel informatie in de <strong>ADSI Library</strong>, en
dus NIET in <strong>AdsiEdit</strong>!!!<br>
Bekijk het handig overzicht van de ADSI interfaces voor elk type
ADSI object in volgende secties:
<ul>
<li><em><nobr>ADSI Interfaces</nobr> / <nobr>ADSI Objects and
Interfaces</nobr> / <nobr>ADSI Object Model for LDAP
Providers</nobr></em>,</li>
<li><em><nobr>ADSI Service Providers</nobr> / <nobr>ADSI LDAP
Provider</nobr> / <nobr>ADSI Objects of LDAP</nobr></em></li>
</ul>
Omdat elk ADSI object ook een <strong>GenObject</strong> is, zijn
een aantal ADSI&nbsp;interfaces, zoals <strong>IADs</strong>,
<strong>IADsContainer</strong>, <strong>IADsPropertyList</strong>
en <strong>IDirectorySearch</strong>, generisch. Ze bieden
gemeenschappelijke ADSI-attributen en methods aan, bruikbaar voor
<strong>alle</strong> ADSI objecten.<br>
Informatie over de ADSI-interface vind je enkel in de <strong>ADSI
Library</strong>, in de subtak <em><nobr>ADSI
Interfaces</nobr></em>. Het overzicht <em><nobr>Alphabetical
Listing of ADSI Interfaces</nobr></em> toont dat de
ADSI&nbsp;interfaces opgedeeld worden in categoriën. De
documentatie is verder gestructureerd volgens categorie. Zo vind je
informatie over <strong>IADs</strong> terug in de subtak <em>Core
Interfaces</em>. In de subtak <em>IADs</em> vind je uiteindelijk de
lijst van ADSI-attributen in de tak <em>IADs Property Methods</em>.
<dl class="compact">
<dt>6.</dt>
<dd>Zoek in de manual de 6 ADSI-attributen die beschikbaar zijn via
de <strong>IADs</strong> interface. Initialiseer een ADSI object
naar keuze (bijvoorbeeld een domaincontroller), en schrijf de
waarde van deze zes ADSI-attributen uit.<br>
<strong>Opmerking PowerShell:</strong> je kan deze ADSI-attributen
ook opvragen in PowerShell, maar de meeste ontbreken in de lijst
die je krijgt bij <strong>| Get-Member</strong>.</dd>
<dt>7.</dt>
<dd>Om snel na te gaan of de initialisatie van een ADSI object
gelukt is, kan je het <strong>AdsPath</strong> van dit object
uitschrijven. Dit ADSI-attribuut is altijd beschikbaar.<br>
Voor de meeste ADSI&nbsp;objecten zijn er ook een aantal
ADSI&nbsp;interfaces, die specifiek zijn voor de klasse
(bijvoorbeeld <strong>IADsUser</strong> voor <em>user</em>
AD&nbsp;objecten).<br>
Initialiseer een ADSI-object met de AD-object dat je eigen user
beschrijft. De gegevens van jezelf vind je terug in een
<em>user</em> object in de container met <em>canonicalName</em>
<strong>/iii.hogent.be/iii/studenten/EM7INF</strong>. Toon voor dit
AD-object het <strong>AdsPath</strong> en het mail-adres.</dd>
</dl>
<h5>AD objecten met LDAP-attributen versus ADSI objecten met
ADSI-attributen</h5>
De ADSI-attributen van een ADSI object, door Microsoft meestal
<em>properties</em> genoemd, worden door meerdere interfaces
vastgelegd. Met deze ADSI-attributen kan maar een beperkt deel van
de eigenschappen van AD objecten worden verwerkt.<br>
Er is veel meer informatie beschikbaar in de
<strong>LDAP-attributen</strong> van de <strong>AD
objecten</strong>. De Microsoft documentatie spreekt doorgaans van
<em>attributes</em>, zondermeer. De LDAP-attributen van een AD
object liggen vast in het schema van Active Directory (zie
theorie). De naam, de syntax en de inhoud van alle beschikbare
LDAP-attributen van een specifiek AD object kan je wel bekijken met
<strong>AdsiEdit</strong>.
<p>Er is geen 1-op-1 verband tussen de
<strong>LDAP-attributen</strong> van het <strong>AD
object</strong>, en de <strong>ADSI-attributen</strong> van het
overeenkomstige <strong>ADSI object</strong>. Er zijn
LDAP-attributen die geen ADSI equivalent hebben, en omgekeerd.
Bovendien hebben overeenkomstige ADSI- en LDAP-attributen dikwijls
een verschillende naam, en soms zelfs een ander formaat. Er is soms
een groot verschil tussen syntax en inhoud van een LDAP-attribuut
en zijn <em>overeenkomstig</em> ADSI-attribuut. Twee redenen zijn
hiervoor verantwoordelijk:</p>
<ul>
<li>ADSI biedt ook een interface naar andere directories dan de
Active Directory van Windows Server,</li>
<li>ADSI bestaat uit een aantal interfaces, waarvan een aantal
specifiek zijn voor een bepaalde klasse AD&nbsp;objecten
(bijvoorbeeld <strong>IADsUser</strong> voor <em>user</em>
AD&nbsp;objecten). Elke interface implementeert slechts een beperkt
aantal attributen.</li>
</ul>
<p>Onderstaande tabel geeft <strong>enkele voorbeelden</strong> van
ADSI-attributen uit <strong>IADs</strong> met hun overeenkomstige
LDAP-attribuut.</p>
<table border="1" align="center">
<tbody><tr class="alternate">
<th colspan="2">IADs<br>
(alle objecten)<br></th>
</tr>
<tr>
<th>ADSI-attribuut</th>
<th>LDAP-attribuut</th>
</tr>
<tr class="alternate">
<td>GUID ( string / singlevalued )</td>
<td>objectGUID ( <strong>byte</strong>-string / singlevalued )</td>
</tr>
<tr>
<td>ADsPath ( string / singlevalued )</td>
<td>distinguishedName (string / singlevalued )</td>
</tr>
<tr class="alternate">
<td>Class ( string / singlevalued )</td>
<td>objectClass ( string / <strong>multi</strong>-valued )</td>
</tr>
</tbody></table>
<h5>Enkele extra mogelijkheden</h5>
<dl class="compact">
<dt>10.</dt>
<dd>&nbsp;<strong><em>AD-gegevens opzoeken met
dsquery</em></strong>
<p>De Windows Server 2003 opdracht <strong>dsquery</strong>,
cfr.§2.2.3 van de theoriecursus, biedt zeer interessante
mogelijkheden om snel een een AD-object op te zoeken en er ook de
LDAP-attributen van op te vragen. Voer dit commando zonder
argumenten uit in een DOS-venster, en je krijgt uitgebreide
informatie. In de volgende reeks leren we dit soort aanvragen in
een script uitwerken met een <em>LDAP-query</em>.<br>
Zoek je eigen AD-object op, door enkel je naam op te geven. Vraag
met een tweede aanroep de waarde van zijn LDAP-attribuut
objectclass en mail.</p>
<p>Indien je <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=c16ae515-c8f4-47ef-a1e4-a8dcbacff8e3&DisplayLang=en">
dsquery</a> van buiten het domein wilt gebruiken, dan moet je extra
opties (<strong>-s</strong>, <strong>-u</strong>, en
<strong>-p</strong>) toevoegen om je toegang tot het domein te
authentificeren. Bekijk de help met <strong>dsquery user
/?</strong></p>
</dd>
</dl>

        <div id="page-content-end"></div>
    </div>
    <div id="footer">    <div id="metadata">
    Laatst gewijzigd
            op
        13-11-2014
        om
        17:32
        
                door
                    <a href="mailto:Marleen.Denert@UGent.be">Marleen Denert</a>
                
        
    </div>
<div id="tag">intranetr/0.10.0</div>
<div id="footer-end"></div>
</div>
</div>
</div>




<!-- 45 ms / 620 KB -->
<div id="popout" style="display: block; height: 200px;" class=""><div id="popout-panel"><div id="popout-grow" class="popout-button" style="display: block;"></div><div id="popout-shrink" class="popout-button" style="display: block;"></div><div id="popout-close" class="popout-button" style="display: block;"></div><div id="popout-contents" style="display: block; height: 200px;"><pre>use Win32::OLE qw(in);

my $obj=bind_object("LDAP://193.190.126.71/CN=Satan,OU=Domain Controllers,DC=iii,DC=hogent,DC=be");
print (Win32::OLE-&gt;LastError()?"not oke":"oke"),"\n";

sub bind_object{
   my $moniker=shift;
   my $dso = Win32::OLE-&gt;GetObject("LDAP:")   ;
   my $loginnaam = ".....";         #vul in
   my $paswoord  = ".....";         #vul in
#   print "Moniker        : $moniker\n";
   return $dso-&gt;OpenDSObject($moniker, $loginnaam, $paswoord, 1);
}

</pre></div></div></div><img src="./4_files/throbber.gif" style="position: absolute; left: 50%; top: 50%;margin: -15px 0 0 -15px; z-index: 100; display: none;"></body></html>